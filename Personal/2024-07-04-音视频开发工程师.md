---
category: Personal
date: 2024-07-04 09:00:00 +0800
layout: post
titile: 音视频开发工程师
tag: Personal
---
## 简介

+ 音视频开发相关笔记

## C++语言在音视频相关业务中的优势与劣势

### 优势

+ 性能卓越： 
  + C++作为一种静态类型、编译型语言，直接生成机器码，执行效率极高。在音视频编解码、实时处理、特效渲染等对性能要求严苛的场景中，C++可以直接操纵硬件资源，实现接近底层的优化，保证低延迟、高帧率和高质量的音视频输出。

+ 丰富的库与工具链：
  + C++在音视频处理领域有着悠久的历史和深厚的积淀，拥有大量的成熟库和工具链，如FFmpeg、OpenCV、OpenSSL、GStreamer、VLC等，涵盖编解码、滤镜、流媒体传输、加密、图形处理等全方位功能。这些库经过长期打磨，性能稳定，功能强大，能够满足各种复杂的音视频业务需求。

+ 面向对象与模板编程：
  + C++支持面向对象编程，允许开发者通过封装、继承、多态等机制设计清晰、可扩展的系统架构。同时，模板和STL（Standard Template Library）提供了泛型编程能力，有助于编写通用、高效的代码。这对于构建复杂的音视频处理框架和组件化系统非常有利。

+ 对硬件资源的精细控制：
  + C++可以直接访问硬件资源，如CPU缓存、内存、GPU等，进行精细的资源管理和优化。在音视频处理中，这有助于实现内存池、零拷贝技术、异步I/O、多线程/多进程调度等高级特性，最大限度地提高系统性能和效率。

+ 跨平台支持：
  + C++编写的代码通过适当的条件编译和第三方库支持，可以跨多个操作系统（如Windows、Linux、macOS）和硬件平台（如x86、ARM）部署，实现广泛的平台兼容性。

### 劣势

+ 学习曲线陡峭：
  + C++语言特性丰富且复杂，包括指针、内存管理、模板元编程等高级概念，学习成本相对较高。对于初学者或非专业的音视频开发人员，掌握C++并正确使用其高级特性的难度较大。

+ 代码复杂性与错误排查：
  + C++允许程序员进行低级别的操作，虽然带来了灵活性，但也可能导致代码复杂，容易出现内存泄漏、空指针引用、未初始化变量等错误。调试和排查这些问题往往需要深厚的C++知识和经验，以及熟练使用调试工具。

+ 开发效率：
  + 相比于Python、Go等现代语言，C++的开发效率较低。编译时间较长，缺少自动垃圾回收机制，需要手动管理内存，编写和维护代码的工作量较大。尤其是在快速迭代的项目中，C++的开发速度可能成为瓶颈。

+ 安全性：
  + C++没有内置的安全性检查机制，如数组越界检查、空指针检测等。开发者需要自行确保代码的安全性，否则可能会引发运行时错误甚至安全漏洞。在编写音视频处理软件时，需格外注意边界条件和异常处理，以防止程序崩溃或数据损坏。

+ 标准库支持有限：
  + C++标准库在音视频处理相关的功能上较为基础，许多高级功能需要借助第三方库。这增加了项目的依赖管理和版本控制的复杂性，有时需要处理不同库之间的兼容性和接口差异。

## 常见开源框架

### Live555

+ 项目主页:https://www.live555.com/liveMedia/
+ 简介
  + Live555是一个高度成熟的、跨平台的C++开源库，专注于实时流媒体协议的实现。它提供了对多种流媒体传输协议的支持，包括但不限于：
    + RTP (Real-time Transport Protocol)
    + RTCP (Real-time Transport Control Protocol)
    + RTSP (Real-time Streaming Protocol)
    + SIP (Session Initiation Protocol)
  + Live555还支持多种媒体格式的封装和解封装，如MPEG Transport Stream (TS)、H.264/AAC编码的FLV、MP4等。这个库广泛用于构建流媒体客户端（如播放器）和服务器端应用程序，适用于视频会议、IPTV、监控系统等多种场景。
+ 特点
  + 跨平台：支持Windows、Linux、macOS以及嵌入式系统。
  + 全面的协议支持：方便实现基于RTSP、RTP等协议的流媒体服务。
  + 可扩展性：用户可以基于其基础架构开发定制化的流媒体组件。
  + 社区活跃：有丰富的文档和示例代码供开发者参考。

### SRS(Simple Realtime Streaming Server)

+ 项目主页:https://github.com/ossrs/srs
+ 简介:
  + SRS是一款高性能、易用且功能丰富的C++开源流媒体服务器，特别针对实时流媒体场景进行了优化。它支持多种流媒体协议：
    + RTMP (Real-Time Messaging Protocol)
    + HLS (HTTP Live Streaming)
    + DASH (Dynamic Adaptive Streaming over HTTP)
    + WebRTC
+ 特点
  + 高并发：通过多进程模型和高效内存管理实现大规模并发直播和点播服务。
  + 扩展性强：可通过插件系统添加新功能或与其他系统集成。
  + 云原生支持：能够无缝部署在Kubernetes等容器环境中，并与CDN、云存储服务良好对接。
  + 实时转码、录制、截图等功能：内置FFmpeg支持多种媒体处理任务。

### GStreamer

+ 项目主页:https://gstreamer.freedesktop.org/
+ 简介
  + :GStreamer是一个模块化、跨平台的多媒体框架，尽管主要以C语言编写，但其API对C++友好，且拥有丰富的C++绑定。GStreamer不仅适用于流媒体，还能处理音频、视频、图像等各种媒体类型。它采用流水线（pipeline）概念来构建复杂的处理链路，支持以下特性：
    + 多种输入/输出协议：RTSP、RTP、HTTP、HLS、DASH、UDP、TCP等。
    + 广泛的编解码器支持：通过插件系统集成各种音频、视频编码器和解码器。
    + 媒体处理能力：过滤、转换、混音、特效等。
    + 适应多种平台：桌面、移动、嵌入式设备等。

### FFmpeg

+ 项目主页:https://ffmpeg.org/
+ 简介
  + FFmpeg是一个著名的多媒体处理工具集合和库，包含了大量的音频/视频编解码器、格式转换工具以及流处理功能。尽管其命令行工具更广为人知，但FFmpeg的库部分（libavformat、libavcodec等）可以被C++项目直接调用，用于实现流媒体相关的功能，如：
    + 多种流媒体协议解析与封装：RTSP、RTMP、HTTP、HLS等。
    + 音视频编解码：支持几乎所有的主流编码格式。
    + 转码、过滤、流复用与拆分等高级处理。

### ZLMediaKit

+ 项目主页:https://github.com/ZLMediaKit/ZLMediaKit
+ 简介
  + ZLMediaKit是一个高性能、轻量级的C++流媒体服务器框架，专为互联网音视频直播、点播业务设计。它支持多种流媒体协议和功能，适用于构建大规模的流媒体服务平台。
+ 主要特性
  + 协议支持:
    + RTMP：支持Flash、移动端（如H5）的直播推流与拉流。
    + HLS：兼容iOS、Android、桌面浏览器的直播与点播。
    + RTSP：用于传统IP摄像头、NVR等设备的接入与分发。
    + HTTP-FLV：提供低延迟的直播观看体验。
    + WebSocket-FLV：基于WebSocket的低延迟直播传输方式。
    + GB28181：符合中国国标标准的视频监控系统协议。
  + 功能丰富:
    + 简单易用的API，便于快速集成与二次开发。
    + 支持多路同时推流、多路同时拉流。
    + 流媒体录制、时移回放（VOD）功能。
    + 视频转码、水印、截图等媒体处理能力。
    + 支持鉴权、防盗链、IP黑名单等安全措施。
    + 提供HTTP API接口，方便远程管理和监控。
  + 高性能与稳定性:
    + 采用事件驱动、无锁设计，保证高并发下的性能表现。
    + 内存池管理、线程池优化，减少资源消耗。
    + 自动恢复断线重连，保证服务连续性。
    + 支持负载均衡，可集群部署以应对大规模流量。

### Nginx RTMP Module

+ 项目主页:https://github.com/arut/nginx-rtmp-module
+ 简介
  + Nginx RTMP Module是为Nginx服务器添加RTMP（Real-Time Messaging Protocol）支持的一个模块。通过将该模块与Nginx集成，可以将Nginx打造成一个高效的RTMP流媒体服务器，支持直播推流、拉流以及录制等功能。Nginx RTMP Module具有以下特点：
    + 轻量级：基于成熟的Nginx服务器，占用资源少，易于部署和维护。
    + RTMP支持：接收和分发RTMP直播流，兼容常见的推流软件（如OBS）和播放器。
    + HLS支持：自动将RTMP流转化为HLS格式，供移动设备和桌面浏览器播放。
    + 录制与回放：支持按需录制直播流，并通过HTTP提供录像文件的点播服务。
    + 简单配置：通过修改Nginx配置文件即可设置服务器参数、流权限等。

### NGINX-VOD-Module

+ 项目主页:https://github.com/kaltura/nginx-vod-module
+ 简介
  + NGINX-VOD-Module是为Nginx添加视频点播（VOD）功能的模块，主要用于处理HTTP/HTTPS协议下的视频流。与Nginx RTMP Module配合使用，可以构建一套完整的流媒体服务体系。主要特性包括：
    + HTTP/HTTPS VOD：支持通过HTTP/HTTPS协议播放MP4、FLV等格式的视频文件。
    + 切片缓存：对视频文件进行切片缓存，实现平滑的流式播放和快速的随机访问。
    + 带宽节省：通过自适应码率流控和HTTP Range请求，减少网络带宽消耗。
    + DRM支持：集成Widevine、PlayReady等数字版权管理（DRM）系统，保护内容安全。
    + 灵活配置：通过Nginx配置文件定义VOD服务的各项参数和规则。

### MediaServer

+ 项目主页:https://github.com/ossrs/srs/wiki/Product
+ 简介
  + MediaServer是由SRS（Simple Realtime Streaming Server）团队开发的一款全功能、高性能的流媒体服务器，基于C++实现。MediaServer除了继承SRS的优秀特性外，还扩展了更多的功能和协议支持：
    + 全面协议：支持RTMP、HLS、FLV、HTTP-FLV、WebRTC等多种流媒体协议。
    + 超低延迟：优化传输协议和算法，实现亚秒级的直播延迟。
    + 转码与处理：内置FFmpeg，支持实时转码、混流、截图、水印等媒体处理。
    + 云原生：支持Kubernetes、Docker等容器化部署，易于扩展和管理。
    + API管理：提供丰富的HTTP API接口，便于远程控制和统计分析。