## 图像处理 行宽(linesize) 步长(stride) 间距(pitch)

+ 间距，有很多别名，在使用ffmpeg解码时，称为`linesize`；使用ffmpeg转换格式时，称为`stride`

+ 间距，在大多数情况下，其数值和图像的宽度是相同的
+ 现在计算机的cpu都是32位或者64位，一次最少读取4个字节或者8个字节，如果少于这些，反而要做一些额外的工作，会花更长的时间，所以会有一个概念叫做**内存对齐**，将结构体的长度设为4或8的倍数。
+ 间距，也是因为同样的理由出现。图像的操作通常按行操作的，如果图像的所有数据都紧密排列，那么会发生非常多次的读取非对齐内存，会影响效率
+ 间距，就是指图像中的一行图像数据所占的存储空间的长度，它是一个**大于等于图像宽度的内存对齐的长度**。这样每次以行为基准读取数据的时后就能内存对齐，虽然可能会导致内存浪费，但是在内存充裕的今天已经无所谓了。

## 视频基本概念

### 容器

+ 熟悉的`mp4, rmvb, mkv, avi`是多媒体容器文件格式（或称多媒体封装格式），所谓容器，**是指将不同的数据流（视频流，音频流，字幕流）封装在一个文件（载体）中。
+ 播放时各种流分别进行解码等处理，然后输出到显示器和音响等设备进行播放。**多媒体容器格式不同于编码格式，一个容器中可以封装多种编码格式的媒体流。**
+ 流封装了实际的媒体数据，例如视频流，音频流和字幕流等。一般情况下，流中的数据只能使用一种编码格式。

### 帧率

+ 帧率(`frames per second, fps`)，是每秒画面刷新的次数，帧率越高视频越流畅。
+ 一般来说，30`fps`就是可以接受的，60`fps`则可以明显提升交互感，但一般超过75`fps`就不容易察觉到有明显的流畅度提升了

### 分辨率

+ 分辨率表示画面的精细程度，**通常用像素密度来表示**,常用的单位为`ppi`（像素每英尺），通常像素密度越高画面越精细，模糊程度越低
+ 对于视频文件而言，像素密度是无法控制的（由播放器和显式设备决定）。我们通常**用视频的向素数来表示它的分辨率**，例如`1080x640`, `640x320`等

## 比特率

+ 比特率(`bit rate`)，又称码率，表示多媒体流每秒输出的字节数，单位为`KB/s, Kbps`等，同样的压缩算法，比特率越高音视频的质量越好。
+ 可变码率(`Variable Bitrate, VBR`)，指的是编码其的输入码率可以根据输入源信号的复杂度进行自适应调整，以在输出质量保持不变的条件下尽可能减少数据量。VBR适用于存储，不太使用于流式传输。
+ 固定码率(`Constant Bitrate, CBR`), 指的是编码器输出码率固定，CBR不适合存储，对于复杂内容可能没有足够码率进行编码，从而导致质量下降，同时会在简单内容部分浪费一些码率

### 采样率

+ 采样率，指的是每秒钟对音频信号的采样次数，采样频率越高，声音还原度越高，声音更加自然，单位是赫兹Hz
+ 音频文件一般使用的采样率是44.1kHz，也就是一秒钟采样44100次，实验发现低于这个值就会由较明显的损失，而高于这个值人的耳朵已经很难分别，而且增加了数字音频所占的空间

### 视频编码

+ **视频流可以看作图片的序列，我们把这个序列中的一张图片称为一帧**。若存储视频中所有的帧，则会导致数据量过大，不便于存储和传输。
+ 统计表明大多数视频相邻帧之间的区别并不大，所以对于一段变化不大的视频，我们可以先完整编码帧A，其后的B帧只需要编码与A帧不同的部分，B帧后的C帧则只编码与B帧的差异。如此递推，将一段视频编码为一个序列。
+ **当某个图像与之前的图像变化很大，导致无法参考前面的帧来生成，就结束上一个序列，并且将该帧完整编码开始一个新的序列**
+ `H264`是目前流行的一种视频编码算法，它定义了三种帧：完整编码的I帧，参考I帧只包含差异的P帧，以及参考前后帧编码的B帧
+ `H264`采用的核心算法是帧内压缩和帧间压缩。
  + 帧内压缩是生成I帧的算法
  + 帧间压缩是生成B帧和P帧的算法
+ 通常，把完成编码的I帧称为**关键帧**。因为解码非关键帧需要解码其参考的帧，因此在截图等不需要全部解码的操作中，经常截取关键帧以提升性能。

启动mysql
/etc/init.d/mysql start 

启动redis
/etc/init.d/redis-server start

启动mqtt
/etc/init.d/mosquitto start 

启动nginx 
/etc/init.d/nginx start 

启动supervisor
/etc/init.d/supervisor start

启动服务
supervisorctl start all

通过命令supervisorctl status 查看服务是否启动，如果正常启动，control manager websocket 三个线程的状态都是successd
