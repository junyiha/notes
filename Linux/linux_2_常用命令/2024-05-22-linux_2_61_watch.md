---
category: Linux
date: 2024-05-22 09:00:00 +0800
layout: post
title: linux_2_61_watch
---
## 简介

+ watch命令

## linux watch命令 详解

`watch` 是一个 Linux 命令，用于周期性地执行给定的命令，并在终端上显示输出结果。默认情况下，`watch` 每两秒钟刷新一次终端，并显示命令的最新输出。这对于监视实时进程、日志文件或其他动态数据非常有用。以下是 `watch` 命令的详细解释：

### 语法：

```bash
watch [选项] 命令
```

### 常用选项：

- **-n \<秒数\>, --interval=\<秒数\>：** 指定刷新间隔时间，默认为两秒。

- **-d, --differences：** 高亮显示命令输出中发生变化的部分。

- **-t, --no-title：** 隐藏终端顶部的标题行。

- **-h, --help：** 显示帮助信息。

### 示例：

1. **基本用法：**
   ```bash
   watch ls -l
   ```
   这将每两秒运行一次 `ls -l` 命令并显示结果。

2. **指定刷新间隔时间：**
   ```bash
   watch -n 5 df -h
   ```
   使用 `-n` 选项，指定刷新间隔为5秒，监视磁盘空间的变化。

3. **高亮显示差异：**
   ```bash
   watch -d ls -l
   ```
   使用 `-d` 选项，高亮显示输出中发生变化的部分。

4. **隐藏标题行：**
   ```bash
   watch -t du -sh
   ```
   使用 `-t` 选项，隐藏终端顶部的标题行。

5. **查看进程实时信息：**
   ```bash
   watch -n 1 ps aux
   ```
   使用 `-n` 选项，每秒查看一次系统中运行的进程。

### 示例解释：

- **刷新间隔：** 默认情况下，`watch` 每两秒刷新一次。使用 `-n` 选项可以指定刷新间隔，以秒为单位。

- **差异高亮显示：** 使用 `-d` 选项，`watch` 会在输出中高亮显示发生变化的部分，便于识别变化。

- **隐藏标题行：** 使用 `-t` 选项，可以隐藏终端顶部的标题行，使界面更简洁。

- **实时监视命令输出：** `watch` 对于实时监视命令输出非常有用，例如查看磁盘空间、进程列表等。

- **中断操作：** 在 `watch` 运行的终端中，可以使用 `Ctrl+C` 中断操作，停止 `watch` 命令的执行。

`watch` 是一个强大的实用工具，特别适用于需要持续监视输出的场景。

## linux watch命令 常用技巧

`watch` 命令在 Linux 中常用于定期执行命令并显示输出。以下是一些常用的 `watch` 命令技巧：

1. **定期查看日志文件：**
   ```bash
   watch -n 5 tail /var/log/syslog
   ```
   这将每5秒刷新一次 `syslog` 日志文件的末尾，以查看实时的系统日志。

2. **监控文件变化：**
   ```bash
   watch -d ls -l
   ```
   使用 `-d` 选项，高亮显示输出中发生变化的部分，有助于监控文件变化。

3. **监视实时网络连接：**
   ```bash
   watch -n 1 netstat -an
   ```
   使用 `-n` 选项，每秒显示一次网络连接信息，有助于监视实时网络活动。

4. **查看磁盘使用情况：**
   ```bash
   watch -n 5 df -h
   ```
   使用 `-n` 选项，每5秒查看一次磁盘使用情况，以实时监控可用磁盘空间。

5. **实时监视系统资源利用率：**
   ```bash
   watch -n 1 top
   ```
   使用 `-n` 选项，每秒刷新一次 `top` 命令，实时查看系统资源利用率。

6. **定期执行自定义脚本：**
   ```bash
   watch -n 10 /path/to/custom/script.sh
   ```
   使用 `-n` 选项，每10秒执行一次自定义脚本并显示输出。

7. **监控文件夹变化：**
   ```bash
   watch -d ls -l /path/to/directory
   ```
   使用 `-d` 选项，高亮显示输出中发生变化的部分，有助于监控文件夹内文件的变化。

8. **查看系统时间变化：**
   ```bash
   watch -n 1 date
   ```
   使用 `-n` 选项，每秒显示一次当前系统时间，实时查看时间变化。

9. **实时监控网络传输速率：**
   ```bash
   watch -n 1 ifconfig eth0
   ```
   使用 `-n` 选项，每秒显示一次网络接口信息，包括传输速率。

10. **监视进程的 CPU 和内存使用情况：**
    ```bash
    watch -n 1 ps aux
    ```
    使用 `-n` 选项，每秒刷新一次正在运行的进程的 CPU 和内存使用情况。

这些技巧可以使 `watch` 命令更灵活，适应不同的监控和观察需求。根据具体的场景，调整刷新间隔和监控的命令，以获得所需的实时信息。

## watch

+ 简介：
  + watch命令是在Linux环境下，以固定时间间隔观察用户自定义命令运行情况的工具
  + 它暂时清除所有终端内容，并显示所附命令的输出，以及当前系统的日期和时间。
  + 它默认为每2秒更新一次所附命令的输出，`ctrl+c`用于退出
  + 当你需要监控一个命令输出随时间的变化时，watch命令很有用。这包括磁盘使用率、系统正常运行时间或跟踪错误。

+ 语法：
  + `watch [option] [command]`

+ 参数：
  + `[option]`  添加一个选项可以改变观察命令的行为方式
    + -n, --interval  允许你指定输出更新的时间间隔。
    + -d, --differences  突出了输出更新之间的差异。
    + -g, --chgexit  当用户定义的命令的输出发生变化时，退出监视命令
    + -t, --no-title  移除显示时间间隔、命令和当前时间及日期的标题。
    + -b, --beep  如果命令退出时出现错误，则播放声音警报（哔哔声）
    + -p, --precise  试图在-interval选项定义的确切秒数之后运行命令。
    + -e, --errexit  出错时停止输出更新，在按下一个键后退出命令。
    + -c, --color  解释ANSI颜色和样式序列。
    + -x, --exec  将用户定义的命令传递给exec，减少对额外引号的需要。
    + -w, --no-linewrap  关掉换行，截断长行。
    + -h, --help  显示帮助文本并退出
    + -v, --version  显示版本信息并退出

+ 示例
  + `watch -n 5 date`