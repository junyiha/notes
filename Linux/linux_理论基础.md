## 简介

+ linux系统的相关理论知识

## 压缩与解压  

+ 将文件压缩不只是为了节省硬盘空间,同时也可以节省网络传输时间,归档文件方便管理等
+ 压缩可分为无损压缩与有损压缩两种,但不管是采用何种技术模型,其本质内容都是一样的,即** 通过某种特殊的编码方式将数据信息中存在的重复度,冗余度有效地降低,从而达到数据压缩的目的** 
+ 在Linux中很多压缩程序只能针对一个文件进行压缩,当要压缩一大堆文件时,首先得先将一堆文件打成一个包(tar命令),然后再用压缩程序进行压缩(gzip, bzip2命令),就是说压缩会分为两步:先打包再压缩
+ 打包,tar命令可以将多个文件和目录创建一个档案(归档),tar最初是用来在磁带上创建档案;tar命令也可以修改档案中的文件,或者加入新的文件;使用tar程序打出来的包常称为tar包,tar包通常以`.tar`结尾
+ 归档的一般用途:
  + 把一大堆的文件和目录打包成一个tar包,便于网络传输
  + 生成tar包后,再用其他的程序进行压缩
+ 压缩
  + gzip,是GNUzip的缩写,它是一个GNU自由软件的文件压缩程序,文件经过它压缩以后以`.gz`为扩展名.
  + gzip不能用来压缩目录,需要先归档目录,然后再压缩,gzip和tar一起构成了Linux操作系统中流行的文件压缩格式(`.tar.gz`)

## 一切皆文件 

+ "一切皆文件"是Unix/Linux的基本哲学之一,它是指Linux系统中的所有的一切都可以通过文件的方式访问和管理,即使不是文件,也以文件的形式来管理.例如硬件设备,进程,套接字等都抽象成文件,使用统一的用户接口,虽然文件类型各不相同,但是对其提供的却是同一套操作
+ 这里的一切都是单项的,也即所有的东西都单向通过文件系统呈现,反向不一定可行.例如:通过新建文件的方式来创建磁盘设备是行不通的
+ 在Linux中共有7种类型的文件,分为3大类:
  + `-` : 普通文件,包括文本文件和二进制文件
  + `d` : 目录文件(文件夹文件)
  + 特殊文件
    + `l` : 链接文件
    + `c` : 字符设备文件
    + `s` : 套接字(Socket)文件,用于网络通讯,一般由应用程序创建
    + `p` : 命名管道文件
    + `b` : 块文件

## Linux文件基本属性

+ 在 Linux 中第一个字符代表这个文件是目录、文件或链接文件等等
  + 当为 `d` 则是目录
  + 当为 `-` 则是文件
  + 若是 `l` 则表示为链接文档(link file)
  + 若是 `b` 则表示为装置文件里面的可供储存的接口设备(可随机存取装置)
  + 若是 `c` 则表示为装置文件里面的串行端口设备，例如键盘、鼠标(一次性读取装置)

+ 接下来的字符中，以三个为一组，且均为 rwx 的三个参数的组合。其中， r 代表可读(read)、 w 代表可写(write)、 x 代表可执行(execute)
+ 要注意的是，这三个权限的位置不会改变，如果没有权限，就会出现减号 - 而已

+ 每个文件的属性由左边第一部分的 10 个字符来确定
+ 从左至右用 0-9 这些数字来表示
  + 第 0 位确定文件类型，
  + 第 1-3 位确定属主（该文件的所有者）拥有该文件的权限
  + 第 4-6 位确定属组（所有者的同组用户）拥有该文件的权限
  + 第 7-9 位确定其他用户拥有该文件的权限

+ 对于文件来说，它都有一个特定的所有者，也就是对该文件具有所有权的用户
+ 同时，在Linux系统中，用户是按组分类的，一个用户属于一个或多个组
+ 文件所有者以外的用户又可以分为文件所属组的同组用户和其他用户
+ 因此，Linux系统按文件所有者、文件所有者同组用户和其他用户来规定了不同的文件访问权限

+ Linux文件属性有两种设置方法，一种是数字，一种是符号
+ Linux 文件的基本权限就有九个，分别是 owner/group/others(拥有者/组/其他) 三种身份各有自己的 read/write/execute 权限
+ 文件的权限字符为： -rwxrwxrwx ， 这九个权限是三个三个一组的！其中，我们可以使用数字来代表各个权限
  + r  --  4
  + w  --  2
  + x  --  1
+ 每种身份(owner/group/others)各自的三个权限(r/w/x)分数是需要累加的，例如当权限为： -rwxrwx--- 分数则是
  + owner = rwx = 4+2+1 = 7
  + group = rwx = 4+2+1 = 7
  + others= --- = 0+0+0 = 0

## inode索引节点 

+ `inode` 是理解`Unix/Linux`文件系统和硬盘存储的基础
+ 理解`inode`,不仅有助于提高系统操作水平,还有助于体会Unix设计哲学,即如何把底层的复杂性抽象成一个简单概念,从而大大简化用户接口

+ `inode`是什么?
  - 理解`inode`,要从文件存储说起 -- 文件储存在硬盘上,硬盘的最小存储单位叫做**扇区(`Sector`)** ,每个扇区储存`512`字节(相当于`0.5KB`)
  - 操作系统读取硬盘的时候,不会一个扇区一个扇区地读取,这样效率太低.而是**一次性连续读取多个扇区,即一次性读取一个块(`block`)**,这种由多个扇区组成的**块** ,是文件存取的最小单位.**块** 的大小通常是`4KB`,即连续八个扇区(`sector`)组成一个块(`block`)
  - 文件数据都存储在块中,那么还需要一个地方储存文件的**元信息** ,比如文件的创建者,文件的创建日期,文件的大小等.**这种储存文件元信息的区域就叫做`inode`** ,中文译名为**索引节点** 
  - 每一个文件都有对应的inode,里面包含了与该文件有关的信息
  
+ `inode`的内容:
  - `inode`包含文件的元信息,具体来说有:
    + 文件的字节数
    + 文件拥有者的`User ID`
    + 文件用户组的`Group ID`
    + 文件的读,写,执行权限
    + 文件的时间戳,共有三个
      + `ctime`,指inode上一次变动的时间
      + `mtime`,指文件内容上一次变动的时间
      + `atime`,指文件上一次打开的时间
    + 链接数,即有多少文件名指向这个`inode`
    + 文件数据`block`的位置
  - 可以使用`stat`命令,查看某个文件的inode信息

+ `inode`的大小
  - `inode`也会消耗硬盘空间,所以在格式化硬盘的时候,操作系统自动将硬盘分成两个区域,一个是数据区,存放文件数据;另一个是`inode`区(`inode table`),存放`inode`所包含的信息
  - `inode`节点一般占用`128`字节或`256`字节.`inode`节点的总数,在格式化时会自动设定.一般是每`1KB`或每`2KB`就设置一个`inode`
+ inode号码
  - 每个`inode`都有一个号码,操作系统用`inode`号码来识别不同的文件.
  - **`Unix/Linux`系统内部不使用文件名,而是使用`inode`号码来识别文件**.对于系统来说,文件名只是inode号码便于识别的别称或者绰号.
  - 表面上,用户通过文件名打开文件.实际上,系统内部将这个过程分为三步:
    + 系统找到文件名对应的`inode`号码
    + 通过`inode`号码,获取`inode`信息
    + 根据`inode`信息,找到文件数据所在的`block`,读出数据
  - 通过命令`ls -i filename`查看文件名对应的inode号码
  
+ 目录文件
  - `Unix/Linux`系统中,目录(`directory`)也是一种文件.打开目录,实际上就是打开目录文件
  - 目录文件的结构非常简单,就是一系列目录项(`dirent`)的列表.每个目录项由两个部分组成:所包含文件的文件名,以及该文件名对应的`inode`号码
  - **所以在使用`ls -lh`命令查看文件夹大小时,所有的文件夹只有`4KB`大小**
+ `inode`的特殊作用
  - 由于`inode`号码与文件名分离,这种机制导致了一些`Unix/Linux`系统特有的现象
  - 当文件名包含特殊字符,无法正常删除时,可以删除`inode`节点,就能直接删除文件
  - 移动文件或重命名文件,只是改变文件名,不影响`inode`号码,所以在`Linux`中移动文件不论大小基本秒成
  - 打开一个文件后,系统就以`inode`号码来识别文件,不再考虑文件名.因此,系统无法从`inode`号码得知文件名.

## 硬链接和软链接 

+ 在Linux中有两种link(链接)的概念,一般称之为硬链接和软链接(或符号链接)
+ 硬链接
  + 一般情况下,文件名和inode号码是"一一对应"的关系,每个inode号码对应一个文件名(每个文件默认有一个硬链接).但是Unix/Linux系统允许多个文件名指向同一个inode号码
  + 这意味着,可以用不同的文件名访问同样的内容,对文件内容进行修改后,会影响所有文件名.但是,删除一个文件名,不影响另一个文件名的访问,这种情况就被称为"硬链接(hard link)"
  + 创建一个硬链接,就会为文件创建了一个新的文件名.硬链接有两个重要局限性:
    + 硬链接不能链接不在同一系统的文件,也就是说硬链接不能链接与文件不在同一磁盘分区上的文件;
    + 硬链接不能链接目录
  + 一个硬链接和文件本身没有什么区别.当列出一个包含硬链接的文件时,不会有特殊的链接指示说明.当一个硬链接被删除时,文件本身的内容仍然存在(也就是说,它所占用的磁盘空间不会被重新分配),直到所有关联这个文件的硬链接都删掉.
+ 软链接:
  + 创建软链接是为了克服硬链接的局限性
  + 软链接是通过创建一个特殊类型的文件(指针)链接到文件或目录,就像windows的快捷方式
  + 文件A和文件B的inode号码虽然不一样,但是文件A的内容是文件B的路径.读取文件A时,系统会自动将访问指向文件B.因此,无论打开哪一个文件,最终读取的都是文件B,但是,文件A依赖于文件B而存在,如果删除了文件B,打开文件A就会报错:"No such file or directory"
  + 软链接与硬链接最大的不同:文件A指向文件B的文件名,而不是文件B的inode号码

## 安全模型与权限 

+ 在linux系统中,所有的操作实质上都是在进行进程访问文件的操作.在访问文件之前需要取得相应的权限,而权限是通过Linux系统中的安全模型获得的.理论上进程所拥有的权限与执行它的用户的权限相同.其中涉及的一切内容,都是围绕这个核心进行的.
+ Linux系统中的安全模型,有两种类型:
  + Linux系统上最初的安全模型称为** 自主访问控制(DAC, Discretionary Access Control)** 
  + 后来又增加设计了一个新的安全模型叫** 强制访问控制(MAC, Mandatory Access Control)** 
  + MAC和DAC不是互斥的,DAC是最基本的安全模型,也是最常用的访问控制机制,是Linux必须具有的功能;而MAC是构建在DAC智商的加强安全机制,属于可选模块
+ 文件权限控制
  + 对文件的权限分三组进行控制:
    + `user`对文件属主设定的权限
    + `group`对文件属组设定的权限
    + `othre`对其他者设定的权限
  + 常用的可设定的权限值,包括:
    + `r` : 读权限
    + `w` : 写权限
    + `x` : 执行权限
    + `s` : 强制位权限
    + `t` : 粘滞位权限
    + `i` : 不可修改权限
    + `a` : 只追加权限

## 端口 

+ `netstat  -a  # 列出所有端口`
+ `netstat -at  # 列出所有tcp端口`
+ `netstat -au  # 列出所有udp端口`
+ `netstat -l   # 只显示监听端口`
+ `netstat -lt  # 只列出所有监听tcp端口`
+ `netstat -lu  # 只列出所有监听udp端口`

### 查看指定端口

+ `sudo netstat -tln | grep 8083`
+ `sudo lsof -i:8083`

## 终端,控制台和shell的区别 

+ 终端(terminal)
+ 控制台(console)
  + 控制台是计算机的基本设备,而终端是附加设备
+ Shell俗称壳(用来区别于核)
  + 软件shell,俗称壳,是读取并解释命令的程序.
  + Shell是一个用C语言编写的程序,它是用户使用Linux的桥梁,用户通过Shell访问操作系统内核的服务

## 启动服务 

+ 启动`mysql`
  + 使用`service`启动: `service mysql start`

## Linux系统启动过程 

+ Linux系统的启动过程可以分为五个阶段:
  + 内核的引导
    + 当计算机打开电源后,首先是`BIOS`开机自检,按照`BIOS`中设置的启动设备(通常是硬盘)来启动.
    + 操作系统接管硬件以后,首先读入`/boot`目录下的内核文件
  + 运行init
    + (init程序的类型)
      + SysV:init
      + Upstart:init
      + Systemd:systemd
    + `init`进程是系统所有进程的起点,可以把它比作系统所有进程的老祖宗,没有这个进程,系统中任何进程都不会启动.
  + 系统初始化
  + 建立终端
  + 用户登录系统

