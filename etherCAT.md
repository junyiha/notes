## EtherCAT

+ `EtherCAT`是`Ethernet for Control Automation Technolog`的简称，是一个实时控制的开放标准。

+ `ETG`, `EtherCAT技术小组`，该组织是`Beckhoff`为支持和推广`EtherCAT`而成立的。`ETG`网站是关于`EtherCAT`的信息来源。

### 固定`RxPDOs` 

+ `notes/PDF/AP系列驱动器+EtherCAT+手册V1.0.pdf -- P12`

+ 对于`CSP`(循环同步位置)0x6060的操作方式=8：
  + 接收PDO 4 ： 0x1700
    + `0x6040` -- 控制字
    + `0x607A` -- 轨迹目标位置
    + `0x60B1` -- 速度偏移
    + `0x60B2` -- 转矩偏移

+ 对于`CSV`(循环同步速度)0x6060的操作模式=9：
  + 接收PDO 5：0x1701
    + `0x6040` -- 控制字
    + `0x60FF` -- 目标速度
    + `0x60B2` -- 转矩偏移量

+ 对于`CST`(循环同步转矩)0x6060的操作方式=10：
  + 接收PDO 6：0x1702
    + `0x6040` -- 控制字
    + `0x60FF` -- 目标速度
    + `0x60B2` -- 转矩偏移量

### 固定`TxPDO`

+ 发送PDO 5：0x1B00
  + `0x6041` -- 状态字
  + `0x6064` -- 实际电机位置
  + `0x60F4` -- 位置循环错误（跟随错误）
  + `0x606F` -- 实际电机速度
  + `0x6077` -- 转矩实际值

## PDO

+ 过程数据对象(`Process Data Object, PDO`)，是用来传输实时数据的，提供对设备应用对象的直接访问通道，它用来传输实时短帧数据，具有较高的优先权。
  
+ `PDO`传输的数据必须少于或等于8个字节，`PDO`的**CAN报文数据域**中每个字节都用作数据传输，因此，在应用层上不包含传输控制信息，报文利用率极高。

+ `PDO`通信是基于生产者/消费者的通讯模式，每个`PDO`有一个唯一的标识符且可以通过一个节点发送，但有多个节点可以接收。`PDO`的接收不需要消费者确认。
  - 由生产者发送的`PDO`称为发送PDO`(TPDO)`
  - 消费者接收的`PDO`称为接收PDO`(RPDO)`

+ 每个`PDO`在对象字典中由两个对象描述： 通信参数和映射参数
  - `PDO`通信参数指明使用哪个`COB-ID`，传输类型，禁用时间和定时时间
  - `PDO`映射参数用于设定`PDO`报文中的数据的映射关系，确定要传输的数据在`CAN`报文数据域中的定位。该参数允许`PDO`的生产者和消费者知道正在传输什么信息，而不需要在`CAN`报文中增加额外的协议控制信息，使传输的效率达到最高。一个`PDO`最多可以映射64个对象

+ `PDO`通讯具有三种出发模式：内部事件驱动或内部定时器触发，同步触发，远程请求触发
  - **内部事件驱动或内部定时触发。**通讯由某一事件触发。例如数字I/O口状态改变，超过预先设定的值，定时器中断等都会触发节点发送一个`PDO`。这种模式可使总线负载达到最小，在相对低的波特率下获得比较高的通讯特性。
  - **同步触发。**同步触发`PDO`是指`CANopen`节点收到由管理节点发出的同步报文（同步对象Sync）之后，根据触发报文条件向总线发出`PDO`报文。同步传输又分为周期性和非周期性。周期性是指`CANopen`节点收到一定数量的同步报文之后才开始发送；非周期性`PDO`是指`PDO`触发条件成立之后，当收到下一个同步对象后马上发送`PDO`
  - **远程请求触发。**`PDO`消费者可以给`PDO`生产者发送远程`PDO`请求，相应`PDO`生产者将对远程帧作出相应，向总线上发送相应的`PDO`数据。

+ `PDO`通讯时的触发模式由`PDO`通信参数中的传输类型来确定，传输类型是一个8位无符号整数，这个传输类型值的大小与`PDO`触发方式的对应关系

+ 主站和从站`PDO`通信的机制
  + `PDO`的基本概念及其在对象字典中的索引，在主站和从战采用`PDO`通信方式时，思路是 -- 先配置主站的`PDO`的通信参数(COB-ID,数据传输类型)，再配置从站的通信参数与主站一致，这样就建立了主站与从站的`PDO`通信的关系。然后再通过字典配置主站`PDO`映射参数，配置完成后从主站就可以通过`PDO`通信传输数据。

+ `PDO`传输的“总指挥”就是对象字典。`PDO`发送什么数据，接收什么数据，什么时候发送和接收，发送和接收的数据都放在哪儿，都是由对象字典配置。

## CAN

+ CAN是控制器局域网络(`Controller Area Network, CAN`)的简称，是由以研发和生产汽车电子产品著称的德国`BOSCH`公司开发的，并最终称为国际标准，是国际上应用最广泛的**现场总线**之一

