---
category: Debugger
date: 2024-05-22 09:00:00 +0800
layout: post
title: gdb_2_常用技巧
tag: GDB
---
## 简介

+ gdb工具使用中常见的技巧

## 日志重定向

在使用GDB进行调试时，您可以将GDB的日志输出重定向到文件中。以下是一种方法：

1. 打开终端并运行GDB。

2. 在GDB提示符下，输入以下命令以启用日志记录功能并指定输出文件：
   ```
   set logging file <file_path>
   ```

   将`<file_path>`替换为您想要将日志记录写入的文件路径和文件名。

3. 输入以下命令以开始记录GDB日志：
   ```
   set logging on
   ```

   GDB将开始将日志记录写入指定的文件。

4. 执行您的调试操作，进行需要的步骤和命令。

5. 当您完成调试并想要停止日志记录时，输入以下命令：
   ```
   set logging off
   ```

   GDB将停止将日志写入文件。

请注意，这种方法将GDB的整个会话记录到文件中，包括所有输入和输出。这对于调试复杂的问题或追踪程序执行流程非常有用。

希望这可以帮助您将GDB的日志输出到文件中。如有其他问题，请随时提问。

---

## 启动程序 输入 参数

+ 示例：
```bash
gdb --args ./mnc.exe --port=10008 --ip=0.0.0.0
```

## gdb 查看断点

要查看在GDB中设置的所有断点，你可以使用以下命令：

```
info breakpoints
```

该命令会显示当前设置的所有断点的列表，包括断点编号、断点位置和断点条件（如果有设置条件的话）。例如：

```
(gdb) info breakpoints
Num     Type           Disp Enb Address            What
1       breakpoint     keep y   0x000000000040051a in main at example.c:10
2       breakpoint     keep y   0x00000000004004f6 in foo at example.c:5
```

在这个例子中，有两个断点，编号为1和2。第一个断点位于文件`example.c`的第10行的`main`函数处，第二个断点位于第5行的`foo`函数处。

如果你只想查看某个特定断点的详细信息，你可以使用以下命令，并将`<breakpoint>`替换为断点的编号：

```
info breakpoints <breakpoint>
```

例如，要查看断点1的详细信息，可以执行以下命令：

```
(gdb) info breakpoints 1
```

这将显示关于断点1的更多信息，如断点位置、断点条件等。

---

## gdb 选项 详解

GDB（GNU Debugger）是一个功能强大的调试工具，用于在Linux和其他操作系统上调试程序。GDB 9.2版本引入了许多新的选项和功能，以下是一些常用的选项的详解：

1. `-ex "command"`：在启动GDB后执行指定的GDB命令。可以使用多个`-ex`选项来执行多个命令。

2. `-tui`：启动GDB的文本用户界面（Text User Interface，TUI）模式。TUI模式提供了源代码和程序状态的交互式显示。

3. `-batch`：以批处理模式运行GDB，不显示交互式命令提示符。适用于自动化脚本或批处理任务。

4. `-core <corefile>`：指定要调试的核心转储文件。核心转储文件包含程序在崩溃或异常终止时的状态信息。

5. `-pid <pid>`：调试指定进程标识符（PID）的正在运行的程序。通过此选项，可以附加到正在运行的进程进行调试。

6. `-symbols=<path>`：指定要加载的调试符号文件的路径。调试符号文件包含程序的符号信息，如变量名、函数名等。

7. `-directory=<path>`：指定要搜索源代码文件的目录。当源代码文件不在当前目录或GDB默认搜索路径中时，可以使用此选项指定源代码的位置。

8. `-quiet`：以静默模式运行GDB，不显示任何冗余的信息。

9. `-ex=dir=<dir>`：指定GDB的工作目录。GDB将在指定的目录中查找程序和其他文件。

10. `-command=<script_file>`：指定要执行的GDB脚本文件。可以在脚本文件中定义自定义的GDB命令和操作。

这些选项只是GDB 9.2版本中的一部分，还有许多其他选项可供使用。你可以参考GDB的官方文档或运行`gdb --help`命令获取完整的选项列表和详细说明。通过熟悉和灵活运用这些选项，你可以根据具体需求使用GDB的功能来调试和分析程序。

---

## gdb 9.2 保存崩溃时堆栈信息

在GDB 9.2中，你可以通过使用`generate-core-file`命令来保存崩溃时的堆栈信息。这个命令会生成一个核心转储文件，其中包含了程序在崩溃时的内存状态和堆栈信息。

以下是保存崩溃时堆栈信息的步骤：

1. 在命令行中使用以下命令启动GDB并加载可执行文件：
```
gdb ./my_program
```

2. 设置断点或者在崩溃发生的地方让程序停下来。你可以使用`break`命令设置断点，或者通过其他方式确保程序会在崩溃时停下来。

3. 运行程序。在GDB命令行中，使用以下命令运行程序：
```
run
```

4. 当程序崩溃时，GDB会自动停在断点处或者崩溃位置。

5. 在GDB命令行中使用以下命令生成核心转储文件：
```
generate-core-file <corefile>
```
其中`<corefile>`是你想要保存核心转储文件的路径和文件名。

6. 此时，核心转储文件就保存了程序崩溃时的堆栈信息和内存状态。

通过保存核心转储文件，你可以在后续的调试过程中使用该文件进行分析。你可以加载核心转储文件并使用GDB命令查看堆栈、变量值等信息，以定位崩溃的原因和解决问题。

需要注意的是，生成核心转储文件可能需要对系统进行相应的配置。确保你的系统允许生成核心转储文件，并且具有足够的权限来保存文件。有些系统默认禁用了核心转储文件的生成，你可能需要修改相应的设置。

另外，记住在发布或共享代码时，避免包含核心转储文件，因为它可能包含敏感信息。核心转储文件主要用于调试和分析崩溃问题。

---

## gdb 9.2 调试核心转储文件

在GDB 9.2中，你可以使用核心转储文件进行调试。核心转储文件是程序在崩溃或异常终止时保存的内存状态的快照，它包含了程序崩溃时的堆栈信息和内存数据。以下是使用GDB调试核心转储文件的步骤：

1. 启动GDB，并加载可执行文件以及核心转储文件。在命令行中使用以下命令：
```
gdb ./my_program <corefile>
```
其中`<corefile>`是核心转储文件的路径和文件名。

2. 一旦GDB加载了核心转储文件，它会还原程序崩溃时的内存状态。你可以使用GDB命令来查看堆栈信息、变量值等。

3. 使用`backtrace`或`bt`命令查看堆栈跟踪，了解程序崩溃的位置和调用链。

4. 使用其他GDB命令进行调试。你可以使用`print`或`p`命令查看变量值，使用`step`或`s`命令单步执行程序，使用`continue`或`c`命令让程序继续执行等。

5. 分析堆栈信息和变量值，定位问题的原因，并进行修复。

需要注意的是，调试核心转储文件时，可执行文件和核心转储文件必须是对应的，即生成核心转储文件的程序版本与进行调试的程序版本相同。如果可执行文件和核心转储文件不匹配，可能会导致调试结果不准确或无法正常调试。

此外，调试核心转储文件还可以结合其他GDB功能和命令，例如条件断点、内存查看等，以进一步分析问题。GDB提供了丰富的调试功能，可以帮助你定位和解决程序崩溃问题。