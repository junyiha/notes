## 简介

+ EVS01电动吸盘相关的理论基础知识

## 操作模式

+ EVSO1电动吸盘，主要具有两种工作模式：
  + 高级模式
  + 自动模式

## 串口设置

+ 物理接口：
  + RS-485

+ 波特率：
  + 115200 bps (默认)

+ 数据位
  + 8 bit

+ 停止位
  + 1

+ 奇偶校验
  + 无

+ 数据流控制
  + 无

+ 控制寄存器首地址
  + 0x03E8 (1000)

+ 状态寄存器首地址
  + 0x07D0 (2000)

## 命令帧格式

+ 标准Modbus-RTU协议，报文格式如下：
  + `| 设备地址(1 byte) | 功能代码(1 byte) | 数据格式(N * 1 byte) | CRC校验码(2 bytes) |`

+ 设备地址：
  + EVS01电动吸盘在Modbus-RTU通讯网络中的从站地址，其范围为：1-247，参数可修改

+ 功能代码：
  + EVS01电动吸盘支持0x03, 0x04, 0x10等功能码

+ 数据格式：
  + 包括读写数据的寄存器地址，数据长度，数据等

+ CRC校验码： 
  + 数据帧CRC校验码

## Modbus寄存器

+ 电动吸盘具有丰富的读写寄存器,根据不同的寄存器可以实现各类功能,其寄存器包含控制用寄存器、状态反馈寄存器、设备寄存器等,控制用寄存器表如下所示:

![寄存器表](data/register-table.jpg)

## Modbus 功能码

## 控制用寄存器 (0x03E8)

+ 该寄存器是电动吸盘的主要功能寄存器，包含电动吸盘使能，模式切换，动作控制等功能

![0x03E8控制寄存器](data/register_0x03E8.jpg)

## 最大真空度/压力设置寄存器 (0x03E9 高字节)

+ 该寄存器为 rMODE_CH1 = 0x1 时的最大真空度或压力设置寄存器

![0x03E9最大真空度/压力设置寄存器](data/register_0x03E9.jpg)

## 抓取超时时间寄存器 (0x03EA 低字节)

+ 该寄存器为 rMODE_CH1=0x1 时的吸取超时时间设置寄存器

![0x03EA抓取超时时间寄存器](data/register_0x03EA.jpg)

## 最小真空度/压力设置寄存器(0x03EA 高字节)

+ 该寄存器为 rMODE_CH1=0x1 时的最小真空度/压力设置寄存器

![0x03EA最小真空度/压力设置寄存器](data/register_0x03EA_high.jpg)

## 模式切换寄存器(0x03ED 低字节)

![0x03ED模式切换寄存器](data/register_0x03ED.jpg)

### 读保持寄存器(FC03)

+ 功能代码03(FC03)用于读取保持寄存器的状态

+ 读取 控制寄存器 0x03E8(1000) 和 最大真空度/压力设置寄存器(0x03E9)
  + 指令输入：`09 03 03 E8 00 02 45 33`
    + 09 : 从站地址
    + 03 : 功能代码03(读取寄存器状态)
    + 03E8 : 第一个请求的寄存器的地址
    + 0002 : 读取的寄存器数量
    + 4533 : CRC校验
  + 返回值 : `09 03 04 00 00 00 00 73 F3`
    + 09 : 从站地址
    + 03 : 功能代码03(读取寄存器状态)
    + 04 : 数据字节数(2个寄存器 * 2个字节 / 寄存器 = 4个字节)
    + 0000 : 寄存器0x03E8的内容
    + 0000 : 寄存器0x03E9的内容
    + 73F3 : CRC校验